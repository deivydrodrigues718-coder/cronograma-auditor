{% extends "base.html" %}

{% block content %}
<div class="header">
    <h1>Auditor Fiscal RFB</h1>
    <p>Cronograma de Estudos</p>
</div>

<div class="container">
    <div class="card">
        <div class="card-title">üìä Seu Progresso</div>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value">{{ total_horas }}h</div>
                <div class="stat-label">Horas estudadas</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">{{ total_questoes }}</div>
                <div class="stat-label">Quest√µes</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">{{ taxa_acerto }}%</div>
                <div class="stat-label">Taxa de acerto</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">{{ dias_concluidos }}</div>
                <div class="stat-label">Dias completos</div>
            </div>
        </div>
    </div>
    
    {% if dia_atual %}
    <div class="card">
        <div class="card-title">üìÖ Hoje - Dia {{ dia_atual.numero }}</div>
        
        {% set t1 = dia_atual.topico1_id|get_topico %}
        {% set t2 = dia_atual.topico2_id|get_topico %}
        {% set t3 = dia_atual.topico3_id|get_topico %}
        
        <div class="topico-item">
            <div class="topico-nome">{{ t1.disciplina.nome if t1 else 'T√≥pico 1' }}</div>
            <div class="topico-meta">{{ t1.nome if t1 else 'Carregando...' }}</div>
            <div class="topico-meta">‚è±Ô∏è 45 min + 10-20 quest√µes</div>
        </div>
        
        <div class="topico-item">
            <div class="topico-nome">{{ t2.disciplina.nome if t2 else 'T√≥pico 2' }}</div>
            <div class="topico-meta">{{ t2.nome if t2 else 'Carregando...' }}</div>
            <div class="topico-meta">‚è±Ô∏è 45 min + 10-20 quest√µes</div>
        </div>
        
        <div class="topico-item">
            <div class="topico-nome">{{ t3.disciplina.nome if t3 else 'T√≥pico 3' }}</div>
            <div class="topico-meta">{{ t3.nome if t3 else 'Carregando...' }}</div>
            <div class="topico-meta">‚è±Ô∏è 45 min + 10-20 quest√µes</div>
        </div>
        
        <div class="topico-item" style="border-left-color: #fb8c00;">
            <div class="topico-nome">üîÑ Revis√£o 24h</div>
            <div class="topico-meta">15 min - quest√µes r√°pidas e anota√ß√µes</div>
        </div>
        
        <a href="/dia/{{ dia_atual.id }}" class="btn" style="margin-top: 16px;">
            Iniciar Estudo
        </a>
    </div>
    {% endif %}
    
    {% if revisoes_pendentes > 0 %}
    <div class="card">
        <div class="card-title">‚ö†Ô∏è Revis√µes Pendentes</div>
        <p style="color: #718096; font-size: 14px;">
            Voc√™ tem <strong>{{ revisoes_pendentes }}</strong> revis√µes atrasadas.
        </p>
        <a href="/revisoes" class="btn" style="margin-top: 12px; background: #f39c12;">
            Ver Revis√µes
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script>
app.jinja_env.filters['get_topico'] = lambda id: Topico.query.get(id) if id else None
</script>
{% endblock %}
